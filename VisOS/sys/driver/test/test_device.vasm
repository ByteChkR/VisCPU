; ________________ Includes ________________
:include "D:\Users\Tim\Documents\VisCPU\VisOS\sys\driver\term\out.vasm"
; ________________ CONST VALUES ________________
:const test_begin 0xFFFF2000 linker:hide
:const test_fail 0xFFFF2001 linker:hide
:const test_pass 0xFFFF2002 linker:hide
:const test_device_present 0xFFFF2003 linker:hide
; ________________ VARIABLE FIELDS ________________
:data __str_test_passed "PASSED!" linker:hide
:data __str_test_failed "FAILED!" linker:hide
:data __str_test_started "Starting Test:" linker:hide
:data __str_test_started_2 "....." linker:hide
:data __BeginTest_namePtr 1 linker:hide
:data __BeginTest_len 1 linker:hide
:data tmp_2805 1 linker:hide
:data tmp_2806 1 linker:hide
:data __BeginTest_i 1 linker:hide
:data tmp_2812 1 linker:hide
:data tmp_2813 1 linker:hide
:data __FailTest_reasonPtr 1 linker:hide
:data __FailTest_len 1 linker:hide
:data tmp_2817 1 linker:hide
:data tmp_2818 1 linker:hide
:data __FailTest_i 1 linker:hide
:data tmp_2824 1 linker:hide
:data tmp_2825 1 linker:hide
:data tmp_2829 1 linker:hide
:data tmp_2830 1 linker:hide
; ________________ MAIN PROGRAM CODE ________________
HLT
; ________________ FUNCTION CODE ________________
.BeginTest
POP __BeginTest_len
POP __BeginTest_namePtr
:include "D:\Users\Tim\Documents\VisCPU\VisOS\sys\driver\term\out.vasm"
; Start IF
COPY test_device_present tmp_2806
BNZ tmp_2806 bexpr_not_f_2808
LOAD tmp_2805 1
JMP bexpr_not_2807
.bexpr_not_f_2808 linker:hide
LOAD tmp_2805 0
.bexpr_not_2807 linker:hide
BEZ tmp_2805 if_end_2802
LOAD tmp_2806 __str_test_started
PUSH tmp_2806; Push Param ptr_of(str_test_started)
LOAD tmp_2806 14
PUSH tmp_2806; Push Param size_of(str_test_started)
JSR WriteString
PUSH __BeginTest_namePtr; Push Param namePtr
PUSH __BeginTest_len; Push Param len
JSR WriteString
LOAD tmp_2806 __str_test_started_2
PUSH tmp_2806; Push Param ptr_of(str_test_started_2)
LOAD tmp_2806 5
PUSH tmp_2806; Push Param size_of(str_test_started_2)
JSR WriteString
RET
JMP if_end_2802
.if_end_2802 linker:hide
LOAD tmp_2806 0
COPY tmp_2806 __BeginTest_i ; Left: def i ; Right: 0
.while_start_2809 linker:hide
LOAD tmp_2805 0x00
COPY __BeginTest_len tmp_2806
BGE __BeginTest_i tmp_2806 bexpr_lt_2811
LOAD tmp_2805 1
.bexpr_lt_2811 linker:hide
BEZ tmp_2805 while_end_2810
COPY __BeginTest_i tmp_2813
COPY __BeginTest_namePtr tmp_2812
ADD tmp_2812 tmp_2813 ; Apply offset
DREF tmp_2812 tmp_2806 ; Dereference Array Pointer
COPY tmp_2806 test_begin ; Left: test_begin ; Right: VisCPU.HL.Parser.Tokens.Expressions.Operators.Special.HLArrayAccessorOp
COPY __BeginTest_i tmp_2812
LOAD tmp_2806 1
ADD tmp_2812 tmp_2806; Left: i ; Right: 1
COPY tmp_2812 __BeginTest_i ; Left: i ; Right: i(OpPlus)1
JMP while_start_2809
.while_end_2810 linker:hide
LOAD tmp_2806 0x0
COPY tmp_2806 test_begin ; Left: test_begin ; Right: 0x0
RET

.FailTest
POP __FailTest_len
POP __FailTest_reasonPtr
:include "D:\Users\Tim\Documents\VisCPU\VisOS\sys\driver\term\out.vasm"
; Start IF
COPY test_device_present tmp_2818
BNZ tmp_2818 bexpr_not_f_2820
LOAD tmp_2817 1
JMP bexpr_not_2819
.bexpr_not_f_2820 linker:hide
LOAD tmp_2817 0
.bexpr_not_2819 linker:hide
BEZ tmp_2817 if_end_2814
LOAD tmp_2818 __str_test_failed
PUSH tmp_2818; Push Param ptr_of(str_test_failed)
LOAD tmp_2818 7
PUSH tmp_2818; Push Param size_of(str_test_failed)
JSR WriteLine
PUSH __FailTest_reasonPtr; Push Param reasonPtr
PUSH __FailTest_len; Push Param len
JSR WriteLine
RET
JMP if_end_2814
.if_end_2814 linker:hide
LOAD tmp_2818 0
COPY tmp_2818 __FailTest_i ; Left: def i ; Right: 0
.while_start_2821 linker:hide
LOAD tmp_2817 0x00
COPY __FailTest_len tmp_2818
BGE __FailTest_i tmp_2818 bexpr_lt_2823
LOAD tmp_2817 1
.bexpr_lt_2823 linker:hide
BEZ tmp_2817 while_end_2822
COPY __FailTest_i tmp_2825
COPY __FailTest_reasonPtr tmp_2824
ADD tmp_2824 tmp_2825 ; Apply offset
DREF tmp_2824 tmp_2818 ; Dereference Array Pointer
COPY tmp_2818 test_fail ; Left: test_fail ; Right: VisCPU.HL.Parser.Tokens.Expressions.Operators.Special.HLArrayAccessorOp
COPY __FailTest_i tmp_2824
LOAD tmp_2818 1
ADD tmp_2824 tmp_2818; Left: i ; Right: 1
COPY tmp_2824 __FailTest_i ; Left: i ; Right: i(OpPlus)1
JMP while_start_2821
.while_end_2822 linker:hide
LOAD tmp_2818 0x0
COPY tmp_2818 test_fail ; Left: test_fail ; Right: 0x0
RET

.PassTest
:include "D:\Users\Tim\Documents\VisCPU\VisOS\sys\driver\term\out.vasm"
; Start IF
COPY test_device_present tmp_2830
BNZ tmp_2830 bexpr_not_f_2832
LOAD tmp_2829 1
JMP bexpr_not_2831
.bexpr_not_f_2832 linker:hide
LOAD tmp_2829 0
.bexpr_not_2831 linker:hide
BEZ tmp_2829 if_end_2826
LOAD tmp_2830 __str_test_passed
PUSH tmp_2830; Push Param ptr_of(str_test_passed)
LOAD tmp_2830 7
PUSH tmp_2830; Push Param size_of(str_test_passed)
JSR WriteLine
RET
JMP if_end_2826
.if_end_2826 linker:hide
LOAD tmp_2830 0x01
COPY tmp_2830 test_pass ; Left: test_pass ; Right: 0x01
RET

